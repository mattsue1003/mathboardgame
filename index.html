<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•¸å­—åŠ æ¸›æ³•æ¡ŒéŠç”¢ç”Ÿå™¨ - å…¨åŠŸèƒ½æ•´åˆç‰ˆ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        input[type="range"] {
            cursor: pointer;
            height: 6px;
            -webkit-appearance: none;
            background: #e2e8f0;
            border-radius: 999px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #4f46e5;
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useCallback, useMemo } = React;

        // åœ–ç¤ºçµ„ä»¶
        const Icon = ({ name, className = "w-4 h-4" }) => {
            const [svg, setSvg] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const icon = lucide.icons[name];
                    if (icon) {
                        const svgString = icon.toSvg({ class: className });
                        setSvg(svgString);
                    }
                }
            }, [name, className]);
            return <span dangerouslySetInnerHTML={{ __html: svg }} className="inline-block" />;
        };

        const App = () => {
            const [mode, setMode] = useState('asymmetric'); // 'classic' æˆ– 'asymmetric'
            const [layout, setLayout] = useState('9'); // '4', '6', '9'
            const [backImage, setBackImage] = useState(null);
            const [brandTitle, setBrandTitle] = useState("æ•¸å­—åŠ æ¸›æ³•æ¡ŒéŠ");
            const [isGenerating, setIsGenerating] = useState(false);
            
            const renderCanvasRef = useRef(null);
            const [frontPreviewUrl, setFrontPreviewUrl] = useState("");
            const [backPreviewUrl, setBackPreviewUrl] = useState("");

            // æ ¹æ“šæ’ç‰ˆè¨ˆç®—å¡ç‰‡ç‰©ç†å°ºå¯¸
            const layoutConfig = useMemo(() => {
                switch(layout) {
                    case '4': return { rows: 2, cols: 2, width: 90, height: 130, label: 'å¤§å¡ (4å¼µ/A4)' };
                    case '6': return { rows: 3, cols: 2, width: 80, height: 90, label: 'ä¸­å¡ (6å¼µ/A4)' };
                    case '9': return { rows: 3, cols: 3, width: 60, height: 88, label: 'çœç´™ (9å¼µ/A4)' };
                    default: return { rows: 3, cols: 3, width: 60, height: 88, label: 'çœç´™ (9å¼µ/A4)' };
                }
            }, [layout]);

            // æ‰€æœ‰å¾®èª¿åƒæ•¸
            const [sizes, setSizes] = useState({
                titleFontSize: 7,      // ç‰ŒèƒŒæ¨™é¡Œå­—é«” (mm)
                titleYOffset: 15,      // ç‰ŒèƒŒæ¨™é¡Œ Y ä½ç½® (mm)
                imageScale: 0.8,       // ç‰ŒèƒŒåœ–ç‰‡ç¸®æ”¾
                imageXOffset: 0,       // ç‰ŒèƒŒåœ–ç‰‡ X ä½ç§» (mm)
                imageYOffset: 0,       // ç‰ŒèƒŒåœ–ç‰‡ Y ä½ç§» (mm)
                mainNumSize: 40,       // ç‰Œé¢ä¸»æ•¸å­— (mm)
                modFontSize: 11,       // ç‰Œé¢ +- æ•¸å­— (mm)
                modCircleSize: 13,     // ç‰Œé¢ +- åœ“åœˆåŠå¾‘ (mm)
            });

            // ç•¶æ’ç‰ˆæ”¹è®Šæ™‚ï¼Œè‡ªå‹•èª¿æ•´åŸºç¤é è¨­å€¼
            useEffect(() => {
                if (layout === '4') {
                    setSizes(s => ({ ...s, mainNumSize: 45, modFontSize: 12, modCircleSize: 15, titleFontSize: 8 }));
                } else if (layout === '6') {
                    setSizes(s => ({ ...s, mainNumSize: 35, modFontSize: 10, modCircleSize: 12, titleFontSize: 6 }));
                } else {
                    setSizes(s => ({ ...s, mainNumSize: 30, modFontSize: 9, modCircleSize: 11, titleFontSize: 5 }));
                }
            }, [layout]);

            const ppi = 5; // ç¹ªåœ–ç²¾ç´°åº¦

            const getColor = (val) => {
                const v = Math.abs(val);
                if (v === 1) return '#16a34a'; 
                if (v === 2) return '#2563eb'; 
                if (v === 3) return '#dc2626'; 
                return '#334155';
            };

            // ç¹ªè£½æ­£é¢
            const drawFrontCard = useCallback((canvas, card, s, currentMode, cfg) => {
                const ctx = canvas.getContext('2d');
                const w = cfg.width * ppi;
                const h = cfg.height * ppi;
                
                canvas.width = w;
                canvas.height = h;

                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, w, h);
                ctx.strokeStyle = '#cbd5e1';
                ctx.lineWidth = 1 * ppi;
                ctx.strokeRect(0, 0, w, h);

                // ä¸­å¤®æ•¸å­—
                ctx.fillStyle = '#0f172a';
                ctx.font = `900 ${s.mainNumSize * ppi}px sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(card.main.toString(), w / 2, h / 2 + (5 * ppi));

                const drawMarker = (x, y, value, isFlipped) => {
                    const radius = s.modCircleSize * ppi;
                    const color = getColor(value);
                    ctx.save();
                    ctx.translate(x, y);
                    if (isFlipped) ctx.rotate(Math.PI);
                    
                    ctx.beginPath();
                    ctx.arc(0, 0, radius, 0, Math.PI * 2);
                    ctx.fillStyle = '#ffffff';
                    ctx.fill();
                    ctx.strokeStyle = color;
                    ctx.lineWidth = 2 * ppi;
                    ctx.stroke();

                    ctx.fillStyle = color;
                    ctx.font = `bold ${s.modFontSize * ppi}px sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    let label = currentMode === 'classic' ? `Â±${Math.abs(card.mod)}` : (value > 0 ? `+${value}` : `${value}`);
                    ctx.fillText(label, 0, 1 * ppi);
                    ctx.restore();
                };

                const offset = (cfg.width * 0.25) * ppi;
                if (currentMode === 'classic') {
                    drawMarker(w - offset, offset, card.mod, false);
                    drawMarker(offset, h - offset, card.mod, true);
                } else {
                    drawMarker(w - offset, offset, card.plus, false);
                    drawMarker(offset, h - offset, card.minus, true);
                }
                
                const activeColor = currentMode === 'classic' ? getColor(card.mod) : getColor(Math.max(Math.abs(card.plus), Math.abs(card.minus)));
                ctx.fillStyle = activeColor;
                ctx.fillRect(w*0.1, h - (4 * ppi), w*0.8, 2.5 * ppi);
                
                return canvas.toDataURL('image/jpeg', 0.95);
            }, []);

            // ç¹ªè£½èƒŒé¢
            const drawBackCard = useCallback(async (canvas, imgData, title, s, cfg) => {
                const ctx = canvas.getContext('2d');
                const w = cfg.width * ppi;
                const h = cfg.height * ppi;
                canvas.width = w;
                canvas.height = h;

                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, w, h);
                ctx.strokeStyle = '#cbd5e1';
                ctx.lineWidth = 1 * ppi;
                ctx.strokeRect(0, 0, w, h);

                if (title) {
                    ctx.fillStyle = '#4f46e5';
                    ctx.font = `bold ${s.titleFontSize * ppi}px sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'top';
                    ctx.fillText(title, w / 2, s.titleYOffset * ppi);
                }

                if (imgData) {
                    const img = new Image();
                    img.src = imgData;
                    await new Promise(resolve => img.onload = resolve);

                    const baseAreaY = h * 0.25; 
                    const availW = w * 0.8;
                    const availH = h * 0.6;
                    const ratio = img.width / img.height;
                    let dW, dH;
                    
                    if (ratio > availW / availH) {
                        dW = availW * s.imageScale; dH = (availW / ratio) * s.imageScale;
                    } else {
                        dH = availH * s.imageScale; dW = (availH * ratio) * s.imageScale;
                    }

                    const dX = (w - dW) / 2 + (s.imageXOffset * ppi);
                    const dY = baseAreaY + (availH - dH) / 2 + (s.imageYOffset * ppi);

                    ctx.save();
                    ctx.beginPath();
                    const clipW = w * 0.8;
                    const clipH = h * 0.65;
                    if (ctx.roundRect) ctx.roundRect(w * 0.1, baseAreaY, clipW, clipH, 4 * ppi);
                    else ctx.rect(w * 0.1, baseAreaY, clipW, clipH);
                    ctx.clip();
                    ctx.drawImage(img, dX, dY, dW, dH);
                    ctx.restore();
                }
                return canvas.toDataURL('image/jpeg', 0.95);
            }, []);

            useEffect(() => {
                const updatePreviews = async () => {
                    if (!renderCanvasRef.current) return;
                    const exampleCard = mode === 'classic' ? { main: 7, mod: 2 } : { main: 7, plus: 2, minus: -1 };
                    const front = drawFrontCard(renderCanvasRef.current, exampleCard, sizes, mode, layoutConfig);
                    setFrontPreviewUrl(front);
                    const back = await drawBackCard(renderCanvasRef.current, backImage, brandTitle, sizes, layoutConfig);
                    setBackPreviewUrl(back);
                };
                updatePreviews();
            }, [sizes, backImage, brandTitle, mode, layoutConfig, drawFrontCard, drawBackCard]);

            const generateDeck = () => {
                const deck = [];
                const cardsPerType = layout === '9' ? 72 : 72; // çµ±ä¸€ç™¼ 72 å¼µæ–¹ä¾¿æ’ç‰ˆ
                if (mode === 'classic') {
                    const distribution = [
                        { main: 1, mods: { 1: 2, 2: 2, 3: 1 } },
                        { main: 2, mods: { 1: 3, 2: 3, 3: 1 } },
                        { main: 3, mods: { 1: 4, 2: 3, 3: 1 } },
                        { main: 4, mods: { 1: 4, 2: 3, 3: 1 } },
                        { main: 5, mods: { 1: 4, 2: 4, 3: 2 } },
                        { main: 6, mods: { 1: 4, 2: 3, 3: 1 } },
                        { main: 7, mods: { 1: 4, 2: 3, 3: 1 } },
                        { main: 8, mods: { 1: 3, 2: 3, 3: 1 } },
                        { main: 9, mods: { 1: 2, 2: 2, 3: 2 } },
                        { main: 10, mods: { 1: 2, 2: 2, 3: 2 } },
                    ];
                    distribution.forEach(item => {
                        Object.entries(item.mods).forEach(([mod, count]) => {
                            for (let i = 0; i < count; i++) deck.push({ main: item.main, mod: parseInt(mod) });
                        });
                    });
                } else {
                    const types = [
                        { p: 1, m: -2, count: 25 }, { p: 2, m: -1, count: 25 }, 
                        { p: 3, m: -2, count: 12 }, { p: 2, m: -3, count: 10 }, 
                    ];
                    for (let num = 1; num <= 10; num++) {
                        types.forEach(t => {
                            const cardsForNum = Math.ceil(t.count / 10);
                            for(let i=0; i<cardsForNum && deck.length < 72; i++) {
                                deck.push({ main: num, plus: t.p, minus: t.m });
                            }
                        });
                    }
                }
                return deck.sort(() => Math.random() - 0.5).slice(0, 72);
            };

            const exportPDF = async () => {
                setIsGenerating(true);
                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('p', 'mm', 'a4');
                    const deck = generateDeck();
                    const { rows, cols, width, height } = layoutConfig;
                    const cardsPerPage = rows * cols;
                    const totalPages = Math.ceil(deck.length / cardsPerPage);
                    
                    const marginX = (210 - (cols * width)) / 2;
                    const marginY = (297 - (rows * height)) / 2;

                    for (let p = 0; p < totalPages; p++) {
                        if (p > 0) doc.addPage();
                        const pageCards = deck.slice(p * cardsPerPage, (p + 1) * cardsPerPage);
                        pageCards.forEach((card, index) => {
                            const col = index % cols;
                            const row = Math.floor(index / cols);
                            const cardImg = drawFrontCard(renderCanvasRef.current, card, sizes, mode, layoutConfig);
                            doc.addImage(cardImg, 'JPEG', marginX + col * width, marginY + row * height, width, height);
                        });
                    }

                    const backImg = await drawBackCard(renderCanvasRef.current, backImage, brandTitle, sizes, layoutConfig);
                    for (let p = 0; p < totalPages; p++) {
                        doc.addPage();
                        for (let i = 0; i < cardsPerPage; i++) {
                            const col = (cols - 1) - (i % cols); // æ°´å¹³é¡åƒ
                            const row = Math.floor(i / cols);
                            if ((p * cardsPerPage + i) < deck.length) {
                                doc.addImage(backImg, 'JPEG', marginX + col * width, marginY + row * height, width, height);
                            }
                        }
                    }
                    doc.save(`${brandTitle}_${layout}å¼µç‰ˆ.pdf`);
                } catch (err) { console.error(err); } finally { setIsGenerating(false); }
            };

            return (
                <div className="min-h-screen bg-slate-50 pb-20">
                    <canvas ref={renderCanvasRef} className="hidden" />
                    
                    <header className="bg-white border-b sticky top-0 z-50 shadow-sm">
                        <div className="max-w-7xl mx-auto px-6 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
                            <div className="flex items-center gap-3">
                                <div className="p-2 bg-indigo-600 rounded-xl shadow-lg text-white">
                                    <Icon name="sun" className="w-8 h-8" />
                                </div>
                                <div>
                                    <h1 className="text-2xl font-black text-indigo-900 leading-tight">æ•¸å­—åŠ æ¸›æ³•ç”¢ç”Ÿå™¨</h1>
                                    <div className="flex gap-2 mt-1">
                                        <button onClick={()=>setMode('asymmetric')} className={`px-3 py-0.5 rounded-full text-[10px] font-bold uppercase ${mode==='asymmetric'?'bg-indigo-600 text-white':'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>éå°ç¨±æ¨¡å¼</button>
                                        <button onClick={()=>setMode('classic')} className={`px-3 py-0.5 rounded-full text-[10px] font-bold uppercase ${mode==='classic'?'bg-indigo-600 text-white':'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>ç¶“å…¸æ¨¡å¼</button>
                                    </div>
                                </div>
                            </div>
                            <button 
                                onClick={exportPDF} disabled={isGenerating}
                                className={`flex items-center gap-3 px-10 py-4 rounded-2xl font-black text-xl shadow-xl transition-all hover:scale-105 active:scale-95 ${isGenerating ? 'bg-slate-200 text-slate-400' : 'bg-indigo-600 hover:bg-indigo-700 text-white'}`}
                            >
                                {isGenerating ? <Icon name="refresh-cw" className="w-6 h-6 animate-spin" /> : <Icon name="download" className="w-6 h-6" />}
                                {isGenerating ? 'æ¸²æŸ“ä¸­...' : 'ä¸‹è¼‰ PDF'}
                            </button>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-6 mt-8 grid grid-cols-1 lg:grid-cols-12 gap-8">
                        
                        {/* å·¦å´æ§åˆ¶é¢æ¿ */}
                        <div className="lg:col-span-4 space-y-6">
                            
                            {/* æ’ç‰ˆèˆ‡æ¨¡å¼ */}
                            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                                <h2 className="text-lg font-black mb-4 text-indigo-900 flex items-center gap-2">
                                    <Icon name="layout" className="w-5 h-5" /> æ’ç‰ˆèˆ‡æ¨¡å¼é¸æ“‡
                                </h2>
                                <div className="grid grid-cols-3 gap-2 mb-4">
                                    {['4', '6', '9'].map(id => (
                                        <button 
                                            key={id} onClick={() => setLayout(id)}
                                            className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center ${layout === id ? 'border-indigo-600 bg-indigo-50 font-bold' : 'border-slate-100 text-slate-400 hover:border-indigo-200'}`}
                                        >
                                            <Icon name={id === '4' ? 'square' : id === '6' ? 'grid-2x2' : 'grid-3x3'} className="mb-1" />
                                            <span className="text-xs">{id} å¼µ/A4</span>
                                        </button>
                                    ))}
                                </div>
                            </section>

                            {/* ç‰ŒèƒŒèˆ‡åœ–ç‰‡é€²éšè¨­å®š */}
                            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                                <h2 className="text-lg font-black mb-4 text-indigo-900 flex items-center gap-2">
                                    <Icon name="image" className="w-5 h-5" /> ç‰ŒèƒŒèˆ‡åœ–ç‰‡è‡ªè¨‚
                                </h2>
                                <div className="space-y-4">
                                    <div>
                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1 block">å“ç‰Œæ¨™é¡Œ</label>
                                        <input type="text" value={brandTitle} onChange={(e)=>setBrandTitle(e.target.value)} className="w-full p-2 text-sm rounded-lg bg-slate-50 border border-slate-200 outline-none font-bold" />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 flex justify-between">æ¨™é¡Œå¤§å° <span>{sizes.titleFontSize}mm</span></label>
                                            <input type="range" min="3" max="15" step="0.5" value={sizes.titleFontSize} onChange={(e)=>setSizes({...sizes, titleFontSize:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                        </div>
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 flex justify-between">æ¨™é¡Œé«˜åº¦ <span>{sizes.titleYOffset}mm</span></label>
                                            <input type="range" min="5" max="40" step="0.5" value={sizes.titleYOffset} onChange={(e)=>setSizes({...sizes, titleYOffset:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                        </div>
                                    </div>

                                    <div className={`mt-4 border-2 border-dashed rounded-xl p-3 text-center ${backImage ? 'bg-green-50 border-green-200' : 'bg-slate-50 border-slate-200'}`}>
                                        {backImage ? (
                                            <div className="flex items-center justify-between text-[10px] font-bold">
                                                <div className="flex items-center gap-2">
                                                    <img src={backImage} className="w-8 h-8 object-cover rounded" />
                                                    <span className="text-green-600">åœ–ç‰‡å°±ç·’</span>
                                                </div>
                                                <button onClick={() => setBackImage(null)} className="text-red-500 underline">ç§»é™¤</button>
                                            </div>
                                        ) : (
                                            <label className="cursor-pointer text-xs text-indigo-600 font-bold block">
                                                é»æ­¤ä¸Šå‚³ç‰ŒèƒŒåœ–ç‰‡
                                                <input type="file" className="hidden" accept="image/*" onChange={(e) => {
                                                    const file = e.target.files[0];
                                                    if (file) {
                                                        const reader = new FileReader();
                                                        reader.onload = (ev) => setBackImage(ev.target.result);
                                                        reader.readAsDataURL(file);
                                                    }
                                                }} />
                                            </label>
                                        )}
                                    </div>

                                    {backImage && (
                                        <div className="space-y-4 pt-2">
                                            <div>
                                                <label className="text-[10px] font-bold text-slate-400 flex justify-between">åœ–ç‰‡ç¸®æ”¾ <span>{Math.round(sizes.imageScale * 100)}%</span></label>
                                                <input type="range" min="0.1" max="3" step="0.05" value={sizes.imageScale} onChange={(e)=>setSizes({...sizes, imageScale:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                            </div>
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <label className="text-[10px] font-bold text-slate-400 flex justify-between">æ°´å¹³ä½ç§» <span>{sizes.imageXOffset}mm</span></label>
                                                    <input type="range" min="-50" max="50" step="1" value={sizes.imageXOffset} onChange={(e)=>setSizes({...sizes, imageXOffset:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                                </div>
                                                <div>
                                                    <label className="text-[10px] font-bold text-slate-400 flex justify-between">å‚ç›´ä½ç§» <span>{sizes.imageYOffset}mm</span></label>
                                                    <input type="range" min="-50" max="50" step="1" value={sizes.imageYOffset} onChange={(e)=>setSizes({...sizes, imageYOffset:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </section>

                            {/* ç‰Œé¢æ•¸å­—å¤§å° */}
                            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                                <h2 className="text-lg font-black mb-4 text-indigo-900 flex items-center gap-2">
                                    <Icon name="maximize" className="w-5 h-5" /> ç‰Œé¢å°ºå¯¸å¾®èª¿
                                </h2>
                                <div className="space-y-4">
                                    <div>
                                        <label className="text-[10px] font-bold text-slate-400 flex justify-between">ä¸­å¤®ä¸»æ•¸å­— <span>{sizes.mainNumSize}mm</span></label>
                                        <input type="range" min="15" max="70" step="1" value={sizes.mainNumSize} onChange={(e)=>setSizes({...sizes, mainNumSize:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 flex justify-between">æ¨™ç±¤æ–‡å­— <span>{sizes.modFontSize}mm</span></label>
                                            <input type="range" min="5" max="30" step="1" value={sizes.modFontSize} onChange={(e)=>setSizes({...sizes, modFontSize:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                        </div>
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 flex justify-between">æ¨™ç±¤åœ“åœˆ <span>{sizes.modCircleSize}mm</span></label>
                                            <input type="range" min="5" max="30" step="1" value={sizes.modCircleSize} onChange={(e)=>setSizes({...sizes, modCircleSize:parseFloat(e.target.value)})} className="w-full accent-indigo-600" />
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        {/* å³å´é è¦½èˆ‡ç©æ³• */}
                        <div className="lg:col-span-8 space-y-6">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-200">
                                    <div className="text-[10px] font-black text-slate-300 mb-4 uppercase tracking-widest text-center italic">æ­£é¢é è¦½ ({layoutConfig.label})</div>
                                    <div className="flex justify-center bg-slate-100 p-8 rounded-[2rem]">
                                        {frontPreviewUrl && <img src={frontPreviewUrl} className="w-48 h-auto shadow-2xl rounded-xl" />}
                                    </div>
                                </div>
                                <div className="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-200">
                                    <div className="text-[10px] font-black text-slate-300 mb-4 uppercase tracking-widest text-center italic">èƒŒé¢é è¦½ ({layoutConfig.label})</div>
                                    <div className="flex justify-center bg-slate-100 p-8 rounded-[2rem]">
                                        {backPreviewUrl && <img src={backPreviewUrl} className="w-48 h-auto shadow-2xl rounded-xl" />}
                                    </div>
                                </div>
                            </div>

                            {/* ç©æ³•èªªæ˜ */}
                            <section className="bg-white p-8 rounded-[2.5rem] shadow-sm border border-slate-200">
                                <h2 className="text-2xl font-black mb-6 text-indigo-900 flex items-center gap-3">
                                    <Icon name="book-open" className="w-7 h-7" /> {mode === 'classic' ? 'ç¶“å…¸ç‰ˆç©æ³•èªªæ˜' : 'éå°ç¨±å¹³è¡¡ç‰ˆç©æ³•èªªæ˜'}
                                </h2>
                                
                                <div className="space-y-8">
                                    <div className="flex gap-4 items-start">
                                        <div className="bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-black shrink-0 shadow-lg shadow-indigo-100 text-sm">1</div>
                                        <div>
                                            <h3 className="font-black text-slate-800 text-lg">éŠæˆ²æº–å‚™</h3>
                                            <p className="text-sm text-slate-600 leading-relaxed">å¹³å‡åˆ†ç™¼æ‰‹ç‰Œçµ¦ç©å®¶ï¼Œç‰Œé¢æœä¸‹ã€‚ç¿»é–‹ä¸€å¼µã€Œèµ·å§‹ç‰Œã€æ”¾åœ¨ä¸­å¤®ä½œç‚ºåŸºç¤ã€‚</p>
                                        </div>
                                    </div>

                                    <div className="flex gap-4 items-start">
                                        <div className="bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-black shrink-0 shadow-lg shadow-indigo-100 text-sm">2</div>
                                        <div>
                                            <h3 className="font-black text-slate-800 text-lg">{mode === 'classic' ? 'å‡ºç‰Œè¦å‰‡ï¼šé›™å‘é‹ç®—' : 'å‡ºç‰Œè¦å‰‡ï¼šåˆ†å‘é‹ç®—'}</h3>
                                            <p className="text-sm text-slate-600 leading-relaxed">
                                                æ‰€æœ‰äºº<span className="text-indigo-600 font-bold underline mx-1">æ¶å¿«åŒæ™‚å‡ºç‰Œ</span>ï¼Œä¸éœ€è¼ªæµã€‚å‡ºçš„ç‰Œä¸­å¤®æ•¸å­—å¿…é ˆç­‰æ–¼ï¼š<br/>
                                                {mode === 'classic' ? (
                                                    <span className="bg-slate-50 px-2 py-1 rounded font-bold border border-slate-100 inline-block mt-2">ç›®å‰ä¸­å¤®æ•¸å­— Â± å…¶æ¨™ç±¤å€¼</span>
                                                ) : (
                                                    <span className="bg-slate-50 px-2 py-1 rounded font-bold border border-slate-100 inline-block mt-2">ä¸­å¤®æ•¸å­— + å³ä¸Šè§’å€¼ <span className="text-slate-300">æˆ–</span> ä¸­å¤®æ•¸å­— - å·¦ä¸‹è§’å€¼</span>
                                                )}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="bg-amber-50 p-6 rounded-3xl border-l-8 border-amber-400 shadow-inner">
                                        <h4 className="font-black text-amber-800 mb-2 flex items-center gap-2 italic">ğŸ’¡ å¯¦æˆ°ç¯„ä¾‹ (Example):</h4>
                                        {mode === 'classic' ? (
                                            <div className="text-sm text-amber-900 font-medium">
                                                ä¸­å¤®ç‰Œæ˜¯ <span className="text-xl font-black mx-1">7</span>ï¼Œæ¨™ç±¤æ˜¯ <span className="font-bold underline">Â±2</span><br/>
                                                ğŸ‘‰ å¯å‡ºçš„æ‰‹ç‰Œï¼š<span className="bg-white px-3 py-0.5 rounded-lg border-2 border-amber-200 font-black mx-1 text-indigo-600">5</span> (7-2) æˆ– <span className="bg-white px-3 py-0.5 rounded-lg border-2 border-amber-200 font-black mx-1 text-indigo-600">9</span> (7+2)ã€‚
                                            </div>
                                        ) : (
                                            <div className="text-sm text-amber-900 font-medium leading-relaxed">
                                                ä¸­å¤®ç‰Œæ˜¯ <span className="text-xl font-black mx-1">7</span>ï¼Œå³ä¸Š <span className="text-green-600 font-black underline">+2</span>ï¼Œå·¦ä¸‹ <span className="text-red-600 font-black underline">-1</span><br/>
                                                ğŸ‘‰ å¯å‡ºçš„æ‰‹ç‰Œï¼š<span className="bg-white px-3 py-0.5 rounded-lg border-2 border-amber-200 font-black mx-1 text-indigo-600">9</span> (7+2) æˆ– <span className="bg-white px-3 py-0.5 rounded-lg border-2 border-amber-200 font-black mx-1 text-indigo-600">6</span> (7-1)ã€‚
                                            </div>
                                        )}
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
                                        <div className="p-5 bg-indigo-50/50 rounded-2xl border border-indigo-100">
                                            <h4 className="font-black text-indigo-900 mb-2 flex items-center gap-2"><Icon name="rotate-cw" className="w-4 h-4" /> æ•¸å­—å¾ªç’°</h4>
                                            æ•¸å­—ç¯„åœç‚º 1-10ã€‚è‹¥ 10 + 1 å‰‡ç‚º 1ï¼›è‹¥ 1 - 2 å‰‡ç‚º 9ã€‚å°±åƒåœ“åœˆä¸€æ¨£å¾ªç’°ã€‚
                                        </div>
                                        <div className="p-5 bg-indigo-50/50 rounded-2xl border border-indigo-100">
                                            <h4 className="font-black text-indigo-900 mb-2 flex items-center gap-2"><Icon name="check-circle-2" className="w-4 h-4" /> ç²å‹æ¢ä»¶</h4>
                                            æœ€å¿«å‡ºå®Œæ‰‹ä¸­æ‰€æœ‰ç‰Œçš„ç©å®¶ç²å‹ã€‚å‡ºå®Œæœ€å¾Œä¸€å¼µç‰Œè¨˜å¾—å¤§å–Šã€ŒBingoã€ï¼
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </main>

                    <footer className="text-center py-10 text-slate-300 font-bold text-xs tracking-widest uppercase">
                        Digital Math Game Generator Â· Ver 3.0 Â· 2026
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        window.addEventListener('load', () => {
            if (window.lucide) lucide.createIcons();
        });
    </script>
</body>
</html>
